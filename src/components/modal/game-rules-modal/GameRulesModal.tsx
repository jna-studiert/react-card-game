import { useState } from 'react';
import GameRulePage from './GameRulePage';

const rulesData = [
    {
        title: '<hl>Основы игры</hl>',
        content: `
В игре участвуют два игрока. У каждого есть колода из 20 карт ранга от 1 до 5 — по четыре карты каждого ранга.
Перед началом игры колоды перемешиваются, и каждый игрок достаёт три карты и выкладывает их на стол рубашкой вниз — это его защита.`,
    },
    {
        title: '<hl>Определение хода</hl>',
        content: `
Перед началом игры жребий определяет, кто ходит первым. 
Игрок, начинающий ход, считается атакующим. 
Другой игрок — защищающийся.`,
    },
    {
        title: '<hl>Ход игрока</hl>',
        content: `
Атакующий достаёт верхнюю карту из своей колоды и сравнивает её ранг с картами защиты оппонента.
Он может побить любую карту защиты с меньшим рангом. 
Ход продолжается, пока у защиты остаются непобитые карты или пока атакующий не встретит карту, которую не может побить.`,
    },
    {
        title: '<hl>Завершение хода</hl>',
        content: `
После окончания хода:
- Атакующий забирает все побитые карты защиты.
- Защищающийся получает карту атакующего, которая не смогла пробить защиту (если атака была неудачной).
Полученные карты добавляются в конец колоды.
Если защита была полностью пробита — защищающийся получает штрафное очко.`,
    },
    {
        title: '<hl>Восстановление защиты</hl>',
        content: `
Перед каждым новым ходом оба игрока восстанавливают свои три карты защиты, доставая недостающие карты из своей колоды.`,
    },
    {
        title: '<hl>Смена ролей</hl>',
        content: `
После каждого хода игроки меняются ролями: атакующий становится защищающимся, и наоборот.`,
    },
    {
        title: '<hl>Условия проигрыша</hl>',
        content: `
Игрок проигрывает, если не может совершить очередной ход или если получает установленное количество штрафных очков.`,
    },
    {
        title: '<hl>Правила боя карт</hl>',
        content: `
Бой карт происходит сравнением их рангов:
- Карта с более высоким рангом побеждает карту с меньшим.
- Исключение: карту ранга 5 может побить только карта ранга 1.
- При равных рангах атакующий возвращает свою карту в очередь и достаёт следующую.`,
    },
];

export default function GameRulesModal({ onBack }: { onBack: () => void }) {
    const [page, setPage] = useState(0);
    const total = rulesData.length;

    const nextPage = () => setPage((p) => Math.min(p + 1, total - 1));
    const prevPage = () => setPage((p) => Math.max(p - 1, 0));

    return (
        <div className="modal">
            <GameRulePage
                title={rulesData[page].title}
                content={rulesData[page].content}
            />
            <div className="pagination">
                {page !== 0 && (
                    <button className="button-primary" onClick={prevPage}>
                        ← Назад
                    </button>
                )}
                <button className="button-primary" onClick={onBack}>
                    Вернуться в меню
                </button>
                {page !== total - 1 && (
                    <button className="button-primary" onClick={nextPage}>
                        Вперёд →
                    </button>
                )}
            </div>
        </div>
    );
}
